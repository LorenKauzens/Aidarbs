(function(b){var a=function(c,d){this.init("simplepicker",c,d)};a.prototype={constructor:a,init:function(h,c,g){var e=this;e.type=h;e.$select=b(c);e.$select.hide();e.options=b.extend({},b.fn.simplepicker.defaults,g);if(!e.options.setIconValue){e.options.setIconValue=e.options.setOptionValue}e.$optionList=null;if(e.options.picker===true){var i=e.$select.find("> option:selected").text();e.$icon=b('<span class="simplepicker icon" title="'+i+'" role="button" tabindex="0"></span>').insertAfter(e.$select);e.$icon.on("click."+e.type,b.proxy(e.showPicker,e));e.$icon.on("keydown."+e.type,function(k){if(k.which===13){e.showPicker()}});e.options.setIconValue(e.$icon,e.$select.val());e.$picker=b('<span class="simplepicker picker '+e.options.theme+'"></span>').appendTo(document.body);e.$optionList=e.$picker;b(document).on("mousedown."+e.type,b.proxy(e.hidePicker,e));e.$picker.on("mousedown."+e.type,b.proxy(e.mousedown,e));e.$picker.on("keydown."+e.type,function(k){if(k.which===27){k.preventDefault();k.stopPropagation();e.hidePicker()}})}else{e.$inline=b('<span class="simplepicker inline '+e.options.theme+'"></span>').insertAfter(e.$select);e.$optionList=e.$inline}e.$select.find("> option").each(function(){var k=b(this);var s=k.val();var l=k.is(":selected");var t=k.is(":disabled");var n="";if(l===true){n=" data-selected"}var o="";if(t===true){o=" data-disabled"}var r="";if(t===false){r=' title="'+k.text()+'"'}var q="";if(t===false){q=' role="button" tabindex="0"'}var p=b('<span class="option"'+r+' data-value="'+s+'"'+n+o+q+"></span>");e.options.setOptionValue(p,s);e.$optionList.append(p);p.on("click."+e.type,b.proxy(e.optionSpanClicked,e));p.on("keydown."+e.type,function(u){if(u.which===13){u.preventDefault();u.stopPropagation();e.optionSpanClicked(u)}});var m=k.next();if(m.is("optgroup")===true){e.$optionList.append('<span class="vr"></span>')}});if(e.options.picker===true){var f=e.$picker.find("[role=button]");var d=f.first();var j=f.last();d.on("keydown",function(k){if(k.which===9&&k.shiftKey){k.preventDefault();j.focus()}});j.on("keydown",function(k){if(k.which===9&&!k.shiftKey){k.preventDefault();d.focus()}})}},selectOption:function(e){var c=this;var d=c.$optionList.find("> span.option").filter(function(){return b(this).data("value").toLowerCase()===e.toLowerCase()});if(d.length>0){c.selectOptionSpan(d)}else{console.error("The given option '"+e+"' could not be found")}},showPicker:function(){var c=this;var d=this.$icon.offset();this.$picker.css({left:d.left-6,top:d.top+this.$icon.outerHeight()});this.$picker.show(this.options.pickerDelay,function(){c.$picker.find("[role=button]").first().focus()})},hidePicker:function(){var d=this;var c=this.$picker.is(":visible");if(c){this.$picker.hide(this.options.pickerDelay,function(){d.$icon.focus()})}},selectOptionSpan:function(c){var d=c.data("value");var e=c.prop("title");c.siblings().removeAttr("data-selected");c.attr("data-selected","");if(this.options.picker===true){this.options.setIconValue(this.$icon,d);this.$icon.prop("title",e);this.hidePicker()}this.$select.val(d)},optionSpanClicked:function(d){var c=b(d.currentTarget);if(c.is("[data-disabled]")===false){this.selectOptionSpan(c);this.$select.trigger("change")}},mousedown:function(c){c.stopPropagation();c.preventDefault()},destroy:function(){if(this.options.picker===true){this.$icon.off("."+this.type);this.$icon.remove();b(document).off("."+this.type)}this.$optionList.off("."+this.type);this.$optionList.remove();this.$select.removeData(this.type);this.$select.show()}};b.fn.simplepicker=function(d){var c=b.makeArray(arguments);c.shift();return this.each(function(){var g=b(this),f=g.data("simplepicker"),e=typeof d==="object"&&d;if(f===undefined){g.data("simplepicker",(f=new a(this,e)))}if(typeof d==="string"){f[d].apply(f,c)}})};b.fn.simplepicker.defaults={theme:"",picker:false,pickerDelay:0,setIconValue:null,setOptionValue:function(d,c){d.addClass("empty").css("background-color",c)}}})(jQuery);